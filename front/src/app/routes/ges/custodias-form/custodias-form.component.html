<form nz-form ngForm>

    <br>
    <!-- <h1>editCustodiaId: {{editCustodiaId}}</h1> -->
    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Cliente</nz-form-label>
    
      <nz-form-control [nzSpan]="17">
        <nz-input-group style="width: 100%">
          <app-cliente-search name="clienteId" ngModel />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Solicitado por</nz-form-label>
      <nz-form-control [nzSpan]="17">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="descRequirente" type="text" />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Descripcion</nz-form-label>
    
      <nz-form-control [nzSpan]="17">
        <nz-input-group style="width: 100%">
          <textarea rows="5" nz-input name="descripcion" ngModel></textarea>
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>
    
    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Fecha Inicial</nz-form-label>
    
      <nz-form-control [nzSpan]="17">
        <nz-input-group style="width: 100%">
          <nz-date-picker
            [nzShowTime]="{ nzFormat: 'HH:mm' }"
            ngModel
            name ="fechaInicio"
            (ngModelChange)="onChangePeriodo($event)"
          ></nz-date-picker>
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Origen</nz-form-label>
    
      <nz-form-control [nzSpan]="17">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="Direccion" ngModel name="origen" type="text" />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Fecha Final</nz-form-label>
    
      <nz-form-control [nzSpan]="17">
        <nz-input-group style="width: 100%">
          <nz-date-picker
            [nzShowTime]="{ nzFormat: 'HH:mm' }"
            ngModel
            name="fechaFinal"
          ></nz-date-picker>
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Destino</nz-form-label>
    
      <nz-form-control [nzSpan]="17">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="Direccion" ngModel name="destino" type="text" />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>


    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Cant. módulos</nz-form-label>
      <nz-form-control [nzSpan]="7">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="cantModulos" type="number" />
        </nz-input-group>
      </nz-form-control>

      <nz-form-label [nzSpan]="3">Importe módulo</nz-form-label>
      <nz-form-control [nzSpan]="7">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="importeModulos" type="number" (ngModelChange)="onChangeImpo()" />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Cant. Horas excedentes</nz-form-label>
      <nz-form-control [nzSpan]="7">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="cantHorasExced" type="number" />
        </nz-input-group>
      </nz-form-control>

      <nz-form-label [nzSpan]="3">Importe hora excedente</nz-form-label>
      <nz-form-control [nzSpan]="7">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="impoHorasExced" type="number" (ngModelChange)="onChangeImpo()" />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Cant. Km excedentes</nz-form-label>
      <nz-form-control [nzSpan]="7">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="cantKmExced" type="number" />
        </nz-input-group>
      </nz-form-control>

      <nz-form-label [nzSpan]="3">Importe Km excedente</nz-form-label>
      <nz-form-control [nzSpan]="7">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="impoKmExced" type="number" (ngModelChange)="onChangeImpo()" />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Importe Peajes</nz-form-label>
      <nz-form-control [nzSpan]="17">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="impoPeaje" type="number" (ngModelChange)="onChangeImpo()" />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>

    <nz-form-item class="marginElement">
      <nz-form-label [nzSpan]="3">Importe a Facturar</nz-form-label>
      <nz-form-control [nzSpan]="7">
        <nz-input-group style="width: 100%">
          <input nz-input placeholder="" ngModel name="facturacion" type="number" disabled />
        </nz-input-group>
      </nz-form-control>
    </nz-form-item>
    <br>
    @for (control of listInputPersonal; track control; let i = $index) {
      <nz-form-item class="marginElement">
        <nz-form-label  [nzSpan]="3"> Personal </nz-form-label>
        <nz-form-control [nzSpan]="7">
          <nz-input-group style="width: 100%">
            <app-personal-search ngModel name={{i+1}}personalId />
          </nz-input-group>
        </nz-form-control>
        <nz-form-control [nzSpan]="1" style="text-align: center;">
          <a (click)="openDrawer(i+1+'personalId')"><span nz-icon nzType="user" nzTheme="outline"></span></a>
        </nz-form-control>
        <nz-form-label  [nzSpan]="1"> Importe </nz-form-label>
        <nz-form-control [nzSpan]="6">
          <nz-input-group style="width: 100%">
            <input nz-input placeholder="" ngModel name={{i+1}}importePersonal type="number" (ngModelChange)="onChangeImpo()" />
          </nz-input-group>
        </nz-form-control>

        <nz-form-control [nzSpan]="1" style="text-align: right;">
          <button nz-button nzType="dashed" class="add-button" (click)="addPersonal($event)">
            <span nz-icon nzType="plus"></span>
            <!-- Agregar Personal -->
          </button>
        </nz-form-control>
        <nz-form-control [nzSpan]="1" style="text-align: center;">
          <span nz-icon nzType="delete" nzTheme="outline" (click)="removePersonal(control, $event)"></span>
        </nz-form-control>
      </nz-form-item>
      
    }
    <br>
    @for (control of listInputVehiculo; track control; let i = $index) {
      <nz-form-item class="marginElement">
        <nz-form-label  [nzSpan]="3"> Patente </nz-form-label>
        <nz-form-control [nzSpan]="2">
          <nz-input-group style="width: 100%">
            <input nz-input placeholder="" ngModel name={{i+1}}patente type="text"/>
          </nz-input-group>
        </nz-form-control>
        <nz-form-label  [nzSpan]="1"> Dueño </nz-form-label>
        <nz-form-control [nzSpan]="6">
          <nz-input-group style="width: 100%">
            <app-personal-search ngModel name={{i+1}}duenoId />
          </nz-input-group>
        </nz-form-control>
        <nz-form-label  [nzSpan]="1"> Importe </nz-form-label>
        <nz-form-control [nzSpan]="3">
          <nz-input-group style="width: 100%">
            <input nz-input placeholder="" ngModel name={{i+1}}importeVehiculo type="number" (ngModelChange)="onChangeImpo()" />
          </nz-input-group>
        </nz-form-control>
        <nz-form-label  [nzSpan]="1">Peaje</nz-form-label>
        <nz-form-control [nzSpan]="2">
          <nz-input-group style="width: 100%">
            <input nz-input placeholder="" ngModel name={{i+1}}peajeVehiculo type="number" />
          </nz-input-group>
        </nz-form-control>

        <nz-form-control [nzSpan]="1" style="text-align: right;">
          <button nz-button nzType="dashed" class="add-button" (click)="addVehiculo($event)">
            <span nz-icon nzType="plus"></span>
            <!-- Agregar Vehículo -->
          </button>
        </nz-form-control>
        <nz-form-control [nzSpan]="1" style="text-align: center;">
          <span nz-icon nzType="delete" nzTheme="outline" (click)="removeVehiculo(control, $event)"></span>
        </nz-form-control>
      </nz-form-item>
      
    }

    <nz-form-item>
      <nz-form-control style="display: flex; justify-content: center; align-items: center;">    
        <button nz-popconfirm nzType="primary" nzPopconfirmTitle="Confirmar guardar cambios?" nz-button *ngIf="edit" (nzOnConfirm)="save(0)">
          Guardar Cambios
        </button>
      </nz-form-control>
      <nz-form-control style="display: flex; justify-content: center; align-items: center;">    
        <button nz-popconfirm nzType="primary" nzPopconfirmTitle="Confirmar accion?" nz-button *ngIf="editCustodiaId() && edit" (nzOnConfirm)="save(1)">
          Finalizar
        </button>
      </nz-form-control>
      <nz-form-control style="display: flex; justify-content: center; align-items: center;">    
        <button nz-popconfirm nzType="primary" nzPopconfirmTitle="Confirmar accion?" nz-button *ngIf="editCustodiaId() && edit" (nzOnConfirm)="save(2)">
          Cancelar
        </button>
      </nz-form-control>
    </nz-form-item>

</form>
<app-detalle-persona [anio]="periodo().year" [mes]="periodo().month" [SucursalId]="0"
  [PersonalId]="personalId()" [visible]="visibleDrawer" (onClose)="closeDrawer()"></app-detalle-persona>